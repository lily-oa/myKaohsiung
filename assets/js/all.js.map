{"version":3,"sources":["all.js"],"names":["AOS","init","once","offset","refresh","url","select","document","querySelector","tabsList","subtitle","cardList","pageList","data","page","getData","axios","get","then","response","result","records","console","log","renderData","showData","selectGroup","map","item","Zone","newSelect","filter","index","indexOf","value","selectStr","forEach","list","innerHTML","textContent","pagination","updateData","str","content","Picture1","Picdescribe1","Name","Opentime","Add","Tel","Ticketinfo","addEventListener","switchDataSelect","e","target","chosenDistrict","dataFilter","dataset","type","switchDataTabs","preventDefault","nodeName","chosenTab","district","title","nowPage","dataTotal","length","showPerPage","pageTotal","Math","ceil","currentPage","minData","maxData","currentPageData","num","push","hasPage","hasNext","pageBtn","current","pageLen","now","parseInt","i","switchPage","pageClicked","filterData"],"mappings":"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","file":"all.js","sourcesContent":["AOS.init({\n  once: true,\n  offset: 50,\n});\nAOS.refresh();\n\nconst url = 'https://raw.githubusercontent.com/hexschool/KCGTravel/master/datastore_search.json'; //高旅網  api\nconst select = document.querySelector('.select-group'); //行政區\nconst tabsList = document.querySelector('.tabs-list'); //熱門區\nconst subtitle = document.querySelector('.subtitle'); //卡片標題\nconst cardList = document.querySelector('.card-list'); //卡片  ul\nconst pageList = document.querySelector('.pagination-list'); // 分頁\n\nlet data = [];\nlet page = {};\n\n// axios get data  串接外部 api\nfunction getData() {\n  axios.get(url)\n    .then(function (response) {\n      data = response.data.result.records;\n      console.log(data);\n      renderData(data);\n    });\n}\ngetData();\n\n\n// 渲染 select filter  初始化\nfunction renderData(showData) {\n  // 渲染有存在的行政區到選單欄位\n  let selectGroup = showData.map((item) => {\n    return item.Zone;\n  });\n\n  let newSelect = selectGroup.filter((item, index) => {\n    return selectGroup.indexOf(item) == index;\n    \n  });\n  console.log(newSelect.value);\n  let selectStr = `<option value=\"高雄全區\" selected\">-- 高雄全區 --</option>`;\n  newSelect.forEach(function (item) {\n    let list = `<option value=\"${item}\">${item}</option>`;\n    selectStr += list;\n  });\n  select.innerHTML = selectStr;\n  subtitle.textContent = '高雄全區';\n\n  pagination(showData, 1);\n}\n\n// 渲染所有清單資料到畫面上\nfunction updateData(showData) {\n  let str = '';\n  showData.forEach(function (item) {\n    let content = `\n    <li class=\"card\">\n      <div class=\"card-header\" style=\"background-image:url(${item.Picture1})\" title=\"${item.Picdescribe1}\">\n        <div class=\"card-title\">\n          <h4>${item.Name}</h4>\n          <p>${item.Zone}</p>\n        </div>\n      </div>\n      <ul class=\"card-body\">\n        <li>\n          <i class=\"fas fa-clock\"></i>\n          <p>${item.Opentime}</p>\n        </li>\n        <li>\n          <i class=\"fas fa-map-marker-alt\"></i>\n          <p>${item.Add}</p>\n        </li>\n        <li class=\"card-footer-list d-flex flex-lg-column justify-content-lg-start align-items-lg-start\">\n          <div class=\"card-footer-item\" data-charge=\"free\">\n            <i class=\"fas fa-mobile-alt\"></i>\n            <p>${item.Tel}</p>\n          </div>\n          <div class=\"card-footer-item\" data-display=${item.Ticketinfo == '免費參觀' ? \"\" : \"d-none\"}>\n            <i class=\"fas fa-tag\"></i>\n            <p>${item.Ticketinfo}</p>\n          </div>\n        </li>\n      </ul>\n    </li>\n    `;\n    str += content;\n  });\n  cardList.innerHTML = str;\n}\n\n//監聽select change event\nselect.addEventListener('change', switchDataSelect, false);\n\nfunction switchDataSelect(e) {\n  if (e.target.value == '') {\n    return;\n  }\n\n  let chosenDistrict = e.target.value;\n  dataFilter(chosenDistrict);\n\n  // 切換分頁\n  if (e.target.dataset.type === 'tab' || e.target.dataset.type === 'num') {\n    const page = e.target.dataset.page;\n    dataFilter(chosenDistrict);\n    pagination(dataFilter(chosenDistrict), page);\n  }\n  return false;\n}\n// 監聽 tabs click事件\ntabsList.addEventListener('click', switchDataTabs, false);\n\nfunction switchDataTabs(e){\n  e.preventDefault();\n  if(e.target.nodeName !== 'A'){\n    return;\n  };\n\n  let chosenTab = e.target.dataset.district;\n\n  dataFilter(chosenTab);\n\n  // 切換分頁\n  if(e.target.dataset.type === 'page' || e.target.dataset.type === 'num'){\n    const page = e.target.dataset.page;\n    const title = subtitle.textContent;\n    dataFilter(title);\n    pagination(dataFilter(title), page);\n  }\n  return false;\n}\n\n\n\n// 輸入showData 資料，用來計算 page 數量資料\nfunction pagination(data, nowPage) {\n  const dataTotal = data.length;\n  const showPerPage = 6;\n  // 可能會有餘數 -> 無條件進位\n  const pageTotal = Math.ceil(dataTotal / showPerPage);\n  let currentPage = nowPage;\n\n  // 當 \"當前頁數\" 比 \"總頁數\" 大的時候，\"當前頁數\" 就等於 \"總頁數\"\n  if (currentPage > pageTotal) {\n    currentPage = pageTotal;\n  }\n\n  // 最小值公式 -> 當前可顯示的最少資料量\n  const minData = (currentPage * showPerPage) - showPerPage + 1;\n\n  // 最大值公式 \n  const maxData = (currentPage * showPerPage);\n\n  let currentPageData = [];\n  //處理資料\n  data.forEach((item, index) => {\n  //獲取陣列索引，但因為索引是從 0 開始所以要 +1\n    const num = index + 1;\n\n    if (num >= minData && num <= maxData) {\n      currentPageData.push(item); //用來篩選的陣列\n    };\n  });\n\n  // 物件中的資料都是字串\n  page = {\n    dataTotal,\n    pageTotal,\n    currentPage,\n    hasPage: currentPage > 1, //boolean\n    hasNext: currentPage < dataTotal,\n  };\n  // console.log(page);\n  updateData(currentPageData);  //再重新渲染一次畫面\n  pageBtn(page, nowPage);\n}\n\n// 新增頁數功能 渲染在畫面中 ->放到renderData\nfunction pageBtn(page, current) {\n  //console.log(page);\n  let str = '';\n  const pageLen = page.pageTotal; //總共頁數\n  const now = parseInt(page.currentPage);\n  \n  if(current > 1){\n    str += `\n    <li class=\"page-item\">\n      <a href=\"#\" class=\"page-link active\" data-type=\"page\" data-page=\"${now - 1}\">\n        <i class=\"fas fa-angle-left\"></i> prev\n      </a>\n    </li>\n    `;\n  }else{\n    str += `\n      <li class=\"page-item\">\n        <a href=\"#\" class=\"page-link active\" data-type=\"page\" data-page=\"${now}\">\n          <i class=\"fas fa-angle-left\"></i> prev\n        </a>\n      </li>\n    `;\n  };\n\n  for(let i = 1; i <= pageLen; i++){\n    if(parseInt(page.currentPage) === i){\n      str += `\n      <li class=\"page-item\">\n        <a href=\"#\" class=\"page-link active\" data-type=\"num\" data-page=\"${i}\">${i}</a>\n      </li>\n      `;\n    }else{\n      str += `\n      <li class=\"page-item\">\n        <a href=\"#\" class=\"page-link\" data-type=\"num\" data-page=\"${i}\">${i}</a>\n      </li>\n      `;\n    };\n  };\n\n  if(current < pageLen){\n    str += `\n    <li class=\"page-item\">\n      <a href=\"#\" class=\"page-link active\" data-type=\"page\" data-page=\"${now + 1}\">\n        next <i class=\"fas fa-angle-right\"></i>\n      </a>\n    </li>\n    `;\n  }else{\n    str += `\n    <li class=\"page-item\">\n      <a href=\"#\" class=\"page-link\" data-type=\"page\" data-page=\"${now}\">\n        next <i class=\"fas fa-angle-right\"></i>\n      </a>\n    </li>\n    `;\n  };\n\n  pageList.innerHTML = str;\n}\n\n//user 點擊換頁功能 監聽 pageList click event\n  pageList.addEventListener('click', switchPage, false);\n\n// 這一段無效 只能用全區 data\nfunction switchPage(e){\n  e.preventDefault();\n  if(e.target.nodeName !== 'A'){\n    return;\n  };\n  \n  const pageClicked = parseInt(e.target.dataset.page);\n  pagination(data, pageClicked);\n}\n\n// 用這行取代 switch Page 防止換頁監聽資訊遺漏\nfunction dataFilter(chosenDistrict){\n  let filterData = [];\n  data.filter(function(item){\n    if(chosenDistrict === item.Zone){\n      filterData.push(item);\n    } else if (chosenDistrict === '高雄全區'){\n      filterData = data;\n    }\n    return filterData;\n  });\n  \n  \n  select.value = chosenDistrict;\n  subtitle.textContent = chosenDistrict;\n  pagination(filterData, 1);\n  return filterData;\n}"]}